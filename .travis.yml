dist: xenial
language: rust
rust:
  - stable
addons:
  apt:
    packages:
      - libjansson-dev
      - lftp
      - libgstreamer1.0-dev
      - libgstreamer-plugins-base1.0-dev
      - gstreamer1.0-plugins-base
      - gstreamer1.0-plugins-good
      - gstreamer1.0-plugins-bad
      - gstreamer1.0-plugins-ugly
      - gstreamer1.0-libav
cache:
  directories:
    - ${TRAVIS_HOME}/.cargo
before_cache:
  - rm -rf ${TRAVIS_HOME}/.cargo/registry
services: docker
git:
  depth: 1
jobs:
  include:
    - stage: check
      name: Tests
      script: cargo test
    - stage: check
      name: Rustfmt
      install: rustup component add rustfmt-preview
      script: cargo fmt -- --check
    - stage: check
      name: Clippy
      install: rustup component add clippy-preview
      script: cargo clippy
#    - stage: deploy
#      name: Docs
#      install: cargo install mdbook --vers 0.2 --force
#      script: mdbook build docs && bash deploy/docs.sh
#    - stage: deploy
#      name: Kubernetes
#      script: bash deploy/run.sh
stages:
  - name: check
#  - name: deploy
#    if: branch = master AND type = push
notifications:
  email: false

